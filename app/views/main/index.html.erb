<span class="head-under">Search</span>
<div>
  <p>We got <b> <%= pluralize(@num_customers, 'customer') %></b>, have worked on <b> <%= @num_cars %> </b> cars and
    logged <b><%= @num_workorders %></b> workorders.</p>
</div>
<div class="mb10">
  <%= form_tag(main_index_path, method: :get) do %>
      <span class="categories">Customer's Name: </span>
      <%= text_field_tag(:users_search, params[:users_search], :autofocus => true) %>
      <span class="c">Category</span>
      <%= select_tag(:cat, options_for_select(Customer.searchable_fields.map { |fields| [fields.capitalize, fields] }, params[:cat])) %>
      <%= submit_tag('Search', name: nil) %>
  <% end %>
</div>
<!-- Check to see if a search has been submited, and print unless -->
<% if params[:users_search].present? %>
    <div>
      Search Results for "<b><%= params[:users_search] %></b>"
    </div>
<% end %>
<% if @selected_customers.any? %>
    <%= render_paging(@selected_customers) %>
    <table id="nice" cellpadding="5" cellspacing="0" width="70%" class="nice">
      <tr>
        <th>Name</th>
        <th>Phone</th>
        <th>Email</th>
        <th>Cell</th>
        <th>Cars</th>
      </tr>
      <% for customer in @selected_customers %>
          <tr>
            <td><%= link_to(customer.first_name+' '+customer.last_name, edit_customer_path(customer)) %></td>
            <td><%= customer.phone_number %></td>
            <td><%= customer.email %></td>
            <td><%= customer.cell_number %></td>
            <td>
              <% customer_cars = customer.cars %>
              <% if customer_cars.empty? %>
                  <%= link_to 'None', "/cars/index/#{customer.id}" %>
              <% else %>
                  <%= customer_cars.map { |car| link_to(car.car_make.strip, car_path(car)) }.join(' | ').html_safe %>
              <% end %>
            </td>
          </tr>
      <% end %>
    </table>
    <% if @selected_customers.count > 8 %>
        <hr/>
        <p style="text-align: center; color: #66B7E7; font-size: 18px"><a href="#top">Top</a></p>
    <% end %>
<% elsif params.has_key?(:users_search) %>
    <div style="padding: 5px">
      No customers found
    </div>
<% end %>